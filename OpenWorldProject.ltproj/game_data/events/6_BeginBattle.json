[
    {
        "name": "BeginBattle",
        "trigger": "roaming_interrupt",
        "level_nid": "6",
        "condition": "unit.nid == \"Simon\"",
        "commands": [
            [
                "add_portrait",
                [
                    "Simon (Simon)",
                    "MidLeft",
                    "left"
                ]
            ],
            [
                "if",
                [
                    "v(\"FlowerRecruited\")"
                ]
            ],
            [
                "trigger_script",
                [
                    "AppearBySimon (Global AppearBySimon)",
                    "Flower"
                ]
            ],
            [
                "add_portrait",
                [
                    "Flower (Flower)",
                    "FarLeft",
                    "left"
                ]
            ],
            [
                "speak",
                [
                    "Flower",
                    "Awooooo!{w}{br}Grrr..."
                ]
            ],
            [
                "mirror_portrait",
                [
                    "Simon (Simon)"
                ]
            ],
            [
                "end",
                []
            ],
            [
                "speak",
                [
                    "Simon",
                    "He must be up ahead.{w}{br}Best be ready."
                ]
            ],
            [
                "choice",
                [
                    "ApproachVilge",
                    "Begin the battle?",
                    "No,Yes",
                    "80"
                ]
            ],
            [
                "if",
                [
                    "v(\"_last_choice\") == \"Yes\""
                ]
            ],
            [
                "remove_region",
                [
                    "VilgeArea"
                ]
            ],
            [
                "comment",
                [
                    "#Dialogue"
                ]
            ],
            [
                "remove_portrait",
                [
                    "Simon (Simon)",
                    "FLAG(immediate)"
                ]
            ],
            [
                "add_portrait",
                [
                    "Simon (Simon)",
                    "Right"
                ]
            ],
            [
                "speak",
                [
                    "Simon",
                    "This is it. No more holding back."
                ]
            ],
            [
                "move_unit",
                [
                    "Simon (Simon)",
                    "12,6"
                ]
            ],
            [
                "sound",
                [
                    "Fimbulvetr1"
                ]
            ],
            [
                "map_anim",
                [
                    "AOE_Blizzard",
                    "11,6",
                    "0.5",
                    "FLAG(no_block)"
                ]
            ],
            [
                "move_unit",
                [
                    "Simon (Simon)",
                    "13,6"
                ]
            ],
            [
                "wait",
                [
                    "800"
                ]
            ],
            [
                "move_unit",
                [
                    "Vilge (Vilge)",
                    "9,6",
                    "immediate"
                ]
            ],
            [
                "move_unit",
                [
                    "Vilge (Vilge)",
                    "10,6"
                ]
            ],
            [
                "add_portrait",
                [
                    "Vilge (Vilge)",
                    "Left"
                ]
            ],
            [
                "speak",
                [
                    "Vilge",
                    "And what, exactly, are you holding back?"
                ]
            ],
            [
                "speak",
                [
                    "Simon",
                    "You must be Vilge."
                ]
            ],
            [
                "speak",
                [
                    "Vilge",
                    "And you must be a fool, challenging me here."
                ]
            ],
            [
                "speak",
                [
                    "Simon",
                    "Whatever you're doing here, ends today."
                ]
            ],
            [
                "speak",
                [
                    "Vilge",
                    "The ascensions?{w} Oh, don't tell me.{w}{br}Pelopos finally dispatched half-decent knights.{w}{br}Excellent, my current reserve is low."
                ]
            ],
            [
                "speak",
                [
                    "Vilge",
                    "Bring up the shield!{w} And bring me their bodies!{w}{br}In as few pieces as possible."
                ]
            ],
            [
                "remove_portrait",
                [
                    "Vilge (Vilge)"
                ]
            ],
            [
                "move_unit",
                [
                    "Simon (Simon)",
                    "14,6",
                    "FLAG(no_block)"
                ]
            ],
            [
                "move_unit",
                [
                    "Cutthroat (105)",
                    "8,15",
                    "FLAG(no_follow)"
                ]
            ],
            [
                "add_unit",
                [
                    "Wall (101)",
                    "12,6",
                    "warp",
                    "push",
                    "FLAG(no_warn)"
                ]
            ],
            [
                "add_unit",
                [
                    "Wall (102)",
                    "13,6",
                    "warp",
                    "push",
                    "FLAG(no_warn)"
                ]
            ],
            [
                "add_unit",
                [
                    "Wall (103)",
                    "12,7",
                    "warp",
                    "push",
                    "FLAG(no_warn)"
                ]
            ],
            [
                "add_unit",
                [
                    "Wall (104)",
                    "13,7",
                    "warp",
                    "push",
                    "FLAG(no_warn)"
                ]
            ],
            [
                "speak",
                [
                    "Simon",
                    "Damn!{w} We can't get to him with these here.{w}{br}There must be some way through."
                ]
            ],
            [
                "remove_portrait",
                [
                    "Simon (Simon)"
                ]
            ],
            [
                "move_unit",
                [
                    "Simon (Simon)",
                    "16,7"
                ]
            ],
            [
                "move_unit",
                [
                    "Vilge (Vilge)",
                    "4,5",
                    "immediate"
                ]
            ],
            [
                "comment",
                [
                    "#Setup"
                ]
            ],
            [
                "change_roaming",
                [
                    "f"
                ]
            ],
            [
                "remove_talk",
                [
                    "Simon (Simon)",
                    "Soldier (122)"
                ]
            ],
            [
                "remove_talk",
                [
                    "Simon (Simon)",
                    "Cutthroat (105)"
                ]
            ],
            [
                "remove_talk",
                [
                    "Simon (Simon)",
                    "Cutthroat (116)"
                ]
            ],
            [
                "remove_unit",
                [
                    "Cutthroat (122)",
                    "immediate",
                    "FLAG(no_warn)"
                ]
            ],
            [
                "trigger_script",
                [
                    "GenericPreps (Global GenericPreps)"
                ]
            ],
            [
                "if",
                [
                    "game.get_unit(\"Nika\").position"
                ]
            ],
            [
                "add_portrait",
                [
                    "Nika (Nika)",
                    "Left"
                ]
            ],
            [
                "speak",
                [
                    "Nika",
                    "Sorry, Simon...{w} I can't-{w}{br}Keep..."
                ]
            ],
            [
                "add_unit_map_anim",
                [
                    "MapBerserk",
                    "Nika (Nika)",
                    "FLAG(permanent)"
                ]
            ],
            [
                "give_skill",
                [
                    "Nika (Nika)",
                    "Berserk (NikaBerserk)",
                    "FLAG(no_banner)"
                ]
            ],
            [
                "remove_portrait",
                [
                    "Nika (Nika)"
                ]
            ],
            [
                "add_portrait",
                [
                    "Simon (Simon)",
                    "Right"
                ]
            ],
            [
                "speak",
                [
                    "Simon",
                    "Nika?{w} ..?{w} Everyone, be careful.{w}{br}I don't know what she's doing."
                ]
            ],
            [
                "remove_portrait",
                [
                    "Simon (Simon)"
                ]
            ],
            [
                "end",
                []
            ],
            [
                "else",
                []
            ],
            [
                "trigger_script",
                [
                    "ConsolidateToLeader (Global ConsolidateToLeader)"
                ]
            ],
            [
                "move_unit",
                [
                    "Simon (Simon)",
                    "15,6",
                    "immediate",
                    "push"
                ]
            ],
            [
                "end",
                []
            ]
        ],
        "only_once": false,
        "priority": 20
    }
]