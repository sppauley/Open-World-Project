[
    {
        "name": "ConversationStates",
        "trigger": "level_start",
        "level_nid": "MorrisseyCastleRoam",
        "condition": "True",
        "commands": [],
        "only_once": false,
        "priority": 29,
        "_source": [
            "# Kinda just a documentation event for now. May become something.",
            "",
            "trigger_script;MorrisseyCastleRoam ConversationPartners",
            "",
            "for;u;[u.nid for u in game.get_all_units_in_party()]",
            "",
            "    if;game.get_unit(\"{u}\").get_field(\"BattlesBeforeLoyaltyTalk\") is not None and game.get_unit(\"{u}\").get_field(\"BattlesDeployed\") is not None and int(game.get_unit(\"{u}\").get_field(\"BattlesBeforeLoyaltyTalk\")) <= int(game.get_unit(\"{u}\").get_field(\"BattlesDeployed\")) and not game.get_unit(\"{u}\").get_field(\"LoyaltyTalkComplete\")",
            "",
            "        level_var;ScriptToRun;\"{u}\" + \"LoyaltyTalk\"",
            "        trigger_script;{v:ScriptToRun};;;no_warn",
            "",
            "    elif;not game.get_unit(\"{u}\").get_field(\"IntroductionTalkComplete\")",
            "",
            "        level_var;ScriptToRun;\"{u}\" + \"IntroductionTalk\"",
            "        trigger_script;{v:ScriptToRun};;;no_warn",
            "",
            "    end",
            "",
            "",
            "endf",
            "",
            "for;u;static_random.shuffle([u.nid for u in game.get_all_units_in_party() if not u.get_field(\"InConversation\")])",
            "",
            "    if;v(\"{u}\" + \"Partners\") is not None and len(v(\"{u}\" + \"Partners\")) > 0 and any([v(\"{u}\" + \"Partners\")[0] == u.nid for u in game.get_all_units_in_party()])",
            "",
            "        level_var;ScriptToRun;\"{u}\" + v(\"{u}\" + \"Partners\")[0] + \"Talk\"",
            "        trigger_script;{v:ScriptToRun};;;no_warn",
            "",
            "    end",
            "",
            "endf"
        ]
    }
]