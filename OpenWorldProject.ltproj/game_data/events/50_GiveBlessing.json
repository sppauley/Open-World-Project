[
    {
        "name": "GiveBlessing",
        "trigger": "turn_change",
        "level_nid": "50",
        "condition": "game.check_alive(\"Clotho\") and game.check_alive(\"Lachesis\") and game.check_alive(\"Atropos\")",
        "commands": [],
        "only_once": false,
        "priority": 20,
        "_source": [
            "# Iterate through Fates giving a blessing to unit who does not yet have one and who is not one of them",
            "if;v(\"NextBlessingFrom\") == \"Lachesis\"",
            "    # Trigger give Lachesis",
            "    level_var;ValidFatesTargets;[u.nid for u in game.get_enemy_units() if not has_skill(u, \"LachesisBlessingFinale\") and \"Boss\" not in u.tags]",
            "    if;len(v(\"ValidFatesTargets\")) > 0",
            "        #Random num, give skill",
            "        level_var;SelectedEnemy;game.get_random_choice(v(\"ValidFatesTargets\"))",
            "        center_cursor;Lachesis",
            "        wait;300",
            "        map_anim;StatUpSpark;Lachesis",
            "        wait;200",
            "        center_cursor;{v:SelectedEnemy}",
            "        flicker_cursor;{v:SelectedEnemy}",
            "        wait;300",
            "        give_skill;{v:SelectedEnemy};LachesisBlessingFinale",
            "    end",
            "    level_var;NextBlessingFrom;\"Clotho\"",
            "elif;v(\"NextBlessingFrom\") == \"Clotho\"",
            "    # Trigger give Clotho",
            "    level_var;ValidFatesTargets;[u.nid for u in game.get_enemy_units() if not has_skill(u, \"ClothoBlessingFinale\") and \"Boss\" not in u.tags]",
            "    if;len(v(\"ValidFatesTargets\")) > 0",
            "        #Random num, give skill",
            "        level_var;SelectedEnemy;game.get_random_choice(v(\"ValidFatesTargets\"))",
            "        center_cursor;Clotho",
            "        wait;300",
            "        map_anim;StatUpSpark;Clotho",
            "        wait;200",
            "        center_cursor;{v:SelectedEnemy}",
            "        flicker_cursor;{v:SelectedEnemy}",
            "        wait;300",
            "        give_skill;{v:SelectedEnemy};ClothoBlessingFinale",
            "    end",
            "    level_var;NextBlessingFrom;\"Atropos\"",
            "elif;v(\"NextBlessingFrom\") == \"Atropos\"",
            "    # Trigger give Atropos",
            "    level_var;ValidFatesTargets;[u.nid for u in game.get_enemy_units() if not has_skill(u, \"AtroposBlessingFinale\") and \"Boss\" not in u.tags]",
            "    if;len(v(\"ValidFatesTargets\")) > 0",
            "        #Random num, give skill",
            "        level_var;SelectedEnemy;game.get_random_choice(v(\"ValidFatesTargets\"))",
            "        center_cursor;Atropos",
            "        wait;300",
            "        map_anim;StatUpSpark;Atropos",
            "        wait;200",
            "        center_cursor;{v:SelectedEnemy}",
            "        flicker_cursor;{v:SelectedEnemy}",
            "        wait;300",
            "        give_skill;{v:SelectedEnemy};AtroposBlessingFinale",
            "    end",
            "    level_var;NextBlessingFrom;\"Lachesis\"",
            "end"
        ]
    }
]