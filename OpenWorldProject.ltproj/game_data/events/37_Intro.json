[
    {
        "name": "Intro",
        "trigger": "level_start",
        "level_nid": "37",
        "condition": "True",
        "commands": [],
        "only_once": false,
        "priority": 20,
        "_source": [
            "show_layer;gatewalls;immediate",
            "center_cursor;Simon;immediate",
            "",
            "remove_group;RipperGroup;immediate",
            "remove_group;InitialEnemyGroup;immediate",
            "",
            "if;v(\"LiberatedVerstadt\") or v(\"DragonCleared\") or v(\"SwampCleared\")",
            "    # Path to Troy is open, do the battle",
            "    show_layer;eastvillageclosed",
            "    change_roaming;f",
            "    remove_group;RoamGroup;immediate",
            "    trigger_script;Global AppearBySimon;MorrisseyGarrison",
            "",
            "    add_portrait;Morrissey;MidLeft",
            "    add_portrait;Simon;FarLeft",
            "",
            "    s;Morrissey;Lord Verstadt.{w} Thank you for joining me.|I've arranged passage with the guards ahead.|It is clear to me that we both have business with the king,|and his refusal to officially allow visitors has gone to far.",
            "    multi_remove_portrait;Morrissey;Simon",
            "",
            "    move_unit;MorrisseyGarrison;10,21;no_block;no_follow",
            "    move_unit;Simon;10,22",
            "",
            "    add_portrait;Mercenary1;Right",
            "    add_portrait;Morrissey;Left",
            "    s;Morrissey;Soldier. The agreed upon amount.",
            "    s;Mercenary1;Heh, thanks.",
            "    move_portrait;Mercenary1;MidLeft",
            "    wait;200",
            "    move_portrait;Mercenary1;Right",
            "",
            "    s;Mercenary1;Open the gates! Official business.",
            "    remove_portrait;Mercenary1",
            "    remove_portrait;Morrissey",
            "",
            "    hide_layer;gatewalls",
            "",
            "    move_unit;MorrisseyGarrison;11,10;no_block;no_follow",
            "    move_unit;Simon;11,11",
            "",
            "    s;Morrissey;The garrison seems lightly populated.|Be on guard, Simon.",
            "",
            "    add_portrait;Morrissey;Right;mirror",
            "    move_unit;101;11,14",
            "",
            "    add_portrait;Mercenary1;Left",
            "    s;Mercenary1;Lord whatever!",
            "    mirror_portrait;Morrissey",
            "    s;Morrissey;Excuse me?",
            "    s;Mercenary1;There's been a change of plans.",
            "    multi_remove_portrait;Mercenary1;Morrissey",
            "",
            "    move_unit;101;10,20;no_block;no_follow",
            "",
            "    for;u;[u.nid for u in game.get_all_units() if u.team == \"other\" and u.nid != \"MorrisseyGarrison\"]",
            "        change_team;{u};enemy",
            "    endf",
            "",
            "    add_group;RipperGroup;starting;fade;push",
            "    move_unit;116;11,2",
            "",
            "    wait;400",
            "",
            "    add_group;InitialEnemyGroup;starting;fade;push",
            "",
            "    center_cursor;MorrisseyGarrison",
            "    add_portrait;Morrissey;Right",
            "    s;Morrissey;What is the meaning of this?",
            "",
            "    center_cursor;Ripper",
            "    add_portrait;Ripper;Left",
            "    s;Ripper;Things have calmed down a bit too much recently.|You and your lackey have cleaned too deeply!|So we offered the garrison a better deal than yours-|A fortune of gold, and your title for their commander.",
            "",
            "    multi_remove_portrait;Ripper;Morrissey",
            "    center_cursor;Marauder",
            "    flicker_cursor;Marauder",
            "    wait;400    ",
            "",
            "    center_cursor;Simon",
            "    add_portrait;Morrissey;Right",
            "    add_portrait;Simon;Left",
            "",
            "    s;Morrissey;I apologize Simon, I foolishly misjudged our situation. ",
            "    s;Simon;Nothing to be done about it now.|Lord Morrissey, we'll fight off the brigands.",
            "    s;Morrissey;Excellent. I will protect your men to the best of my ability.|The Morrisseys and Verstadts have long triumphed together,|and today will add another verse to that tale!",
            "",
            "    multi_remove_portrait;Simon;Morrissey",
            "",
            "    arrange_formation",
            "    trigger_script;Global GenericPreps",
            "",
            "else",
            "    # Guards turn you away, other interactions",
            "    add_group;RoamGroup;RoamGroup;immediate",
            "    add_talk;Simon;104",
            "    add_talk;Simon;101",
            "    add_talk;Simon;103",
            "end"
        ]
    }
]