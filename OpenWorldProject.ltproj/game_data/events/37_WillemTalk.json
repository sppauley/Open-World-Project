[
    {
        "name": "WillemTalk",
        "trigger": "on_talk",
        "level_nid": "37",
        "condition": "unit2.nid == \"103\"",
        "commands": [],
        "only_once": false,
        "priority": 20,
        "_source": [
            "if;v(\"ArmsDealerUnlocked\") == False and v(\"AgreedToBuyFirstWeapon\") == None",
            "",
            "add_portrait;GenericMage;Right",
            "wait;400",
            "add_portrait;Simon;Left;left",
            "",
            "s;GenericMage;Psst, you!{w} Over here.",
            "s;Simon;Careful, knave. I am armed, and with a party.",
            "s;GenericMage;I am no threat to you! No, no.|I wish to offer you a deal.",
            "s;Simon;Is that so?",
            "s;GenericMage;I have many connections within the capital.|For a modest fee, I could procure weapons for your group.",
            "s;Simon;Or run off with the gold I pay you.",
            "s;GenericMage;No, no. I know the value of repeat business.|For a low fee of 300 gold, you will not be disappointed.",
            "",
            "if;game.get_money() > 299",
            "",
            "    choice;buyfirstweapon;Pay 300 gold?;Yes,No",
            "    if;v('_last_choice') == 'Yes'",
            "        game_var;AgreedToBuyFirstWeapon;True",
            "        game_var;ArmsDealerUnlocked;True",
            "        give_money;-300",
            "        s;Simon;Very well, but I expect you to make good on your word.",
            "        s;GenericMage;Of course. Return soon, and I will have quite the find for you.",
            "    else",
            "        s;Simon;I know better than to spend my army's money on your promises.",
            "        s;GenericMage;Perhaps! But these are dangerous times,|and risks ought to be taken.|Nevertheless, it is your decision.|I will remain here, if you wish to rethink it.",
            "    end",
            "    ",
            "else",
            "",
            "    s;Simon;You cannot expect me to take your proposal seriously.|Find another commander to swindle.",
            "    s;GenericMage;Ha! I'm sorry that you will be losing out, my friend.|Perhaps your coin purse is feeling a tad light?",
            "    s;Simon;Enough! I can't listen to you any longer.",
            "",
            "end",
            "",
            "multi_remove_portrait;Simon;GenericMage",
            "",
            "elif;v(\"ArmsDealerMapsLeft\") == 0",
            "",
            "give_item;Simon;Pocketpoacher",
            "game_var;ArmsDealerMapsLeft;v(\"MAXMapsToArmsDealerUnlock\")",
            "game_var;FirstWeaponReceived;True",
            "",
            "elif;v(\"ArmsDealerMapsLeft\") == 0 and v(\"FirstWeaponReceived\") != None",
            "",
            "game_var;ArmsDealerGone;True",
            "",
            "end"
        ]
    }
]