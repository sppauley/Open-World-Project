[
    {
        "name": "ClearPuzzle3",
        "trigger": "unit_wait",
        "level_nid": "23",
        "condition": "True",
        "commands": [],
        "only_once": false,
        "priority": 10,
        "_source": [
            "if;v(\"PuzzleCompleted\") and game.board.get_unit((9,10)) and game.board.get_unit((9,10)).nid == \"Simon\"",
            "",
            "remove_group;PuzzleCrates3",
            "show_layer;toppuzzlecomplete",
            "if;game.board.get_unit((5,8))",
            "    show_layer;toppuzzlecompletenoleft",
            "elif;game.board.get_unit((6,8))",
            "    show_layer;toppuzzlecompletenomid",
            "else",
            "    show_layer;toppuzzlecompletenoright",
            "end",
            "",
            "reset;Anuki",
            "",
            "move_unit;Lupus;7,8;normal;stack",
            "move_unit;Lupus;4,8",
            "move_unit;Lupus;4,9",
            "move_unit;Lupus;1,9",
            "move_unit;Lupus;1,5",
            "move_unit;Lupus;2,5",
            "",
            "add_portrait;Lupus;FarRight",
            "s;Lupus;Hey, check this out! He's got another statue of himself!",
            "remove_portrait;Lupus",
            "",
            "move_unit;Lupus;7,5",
            "move_unit;Lupus;9,5;swoosh",
            "",
            "remove_unit;TopLeft;warp",
            "remove_unit;TopMid;warp",
            "remove_unit;TopRight;warp",
            "",
            "add_portrait;Lupus;Left",
            "multi_add_portrait;Anuki;Right;Simon;FarRight",
            "s;Lupus;Milord and lady, welcome to Gesmen's vault.|I'll start working on the chests.|Mind checking the exit?",
            "multi_remove_portrait;Simon;Anuki;Lupus",
            "",
            "center_cursor;0,2",
            "flicker_cursor;0,2",
            "wait;400",
            "",
            "center_cursor;Lupus",
            "remove_portrait;Simon",
            "move_unit;Simon;0,2;no_block;no_follow",
            "move_unit;Anuki;8,4;no_follow",
            "add_portrait;Lupus;Right",
            "add_portrait;Anuki;Left;mirror",
            "",
            "s;Anuki;Hey, Lupus.{w} Men like him-|You've gotta believe they'll get their due.",
            "remove_unit;Simon;fade",
            "s;Lupus;This is his due. He'll wake up tomorrow penniless.|That's enough for me.",
            "s;Anuki;Good. I'm glad you're satisfied.",
            "multi_remove_portrait;Anuki;Lupus",
            "",
            "move_unit;Anuki;0,2",
            "remove_unit;Anuki",
            "",
            "center_cursor;Lupus",
            "remove_skill;Lupus;HiddenFlying;no_banner",
            "level_var;PuzzleCompleted;False",
            "",
            "wait;300",
            "",
            "move_unit;Lupus;9,2",
            "sound;Unlock",
            "show_layer;topleftchestopen",
            "wait;300",
            "",
            "move_unit;Lupus;12,3",
            "sound;Unlock",
            "show_layer;toprightchestopen",
            "wait;300",
            "",
            "move_unit;Lupus;14,2;normal;closest;400",
            "add_portrait;Lupus;Left",
            "s;Lupus;Annika.",
            "",
            "remove_unit;TreasureTop;warp",
            "remove_unit;TreasureBottom;warp",
            "",
            "s;Lupus;Why?",
            "move_unit;Lupus;17,2;normal;closest;400",
            "",
            "move_unit;Lupus;15,2",
            "add_portrait;Lupus;Left",
            "",
            "center_cursor;9,2",
            "add_unit;Gesmen;9,15;immediate",
            "move_unit;Gesmen;9,3;no_follow",
            "",
            "# GESMEN CONFRONTATION HERE",
            "",
            "end"
        ]
    }
]